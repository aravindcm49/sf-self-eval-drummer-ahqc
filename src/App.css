:root {
  --canvas-bg: #0f172a;
  --card-bg: #0a1327;
  --ink: #e7edf6;
  --muted-ink: #acb7ca;
  --line: rgba(231, 237, 246, 0.26);
  --line-strong: rgba(231, 237, 246, 0.44);
  --chip-bg: rgba(231, 237, 246, 0.08);
  --choice-bg: #16213c;
  --choice-bg-active: #e7edf6;
  --choice-ink-active: #0f172a;
  --card-soft-alert-bg: rgba(248, 189, 109, 0.12);
  --card-soft-alert-border: rgba(248, 189, 109, 0.42);
  --card-soft-alert-ink: #f5d7aa;
  --card-on-track-bg: rgba(74, 222, 128, 0.1);
  --card-on-track-border: rgba(74, 222, 128, 0.44);
  --card-on-track-ink: #b9f7cb;
  --select-bg: rgba(15, 23, 42, 0.78);
  --card-accent-glow: rgba(96, 165, 250, 0.2);
  --card-accent-glow-stop: rgba(96, 165, 250, 0);
  --card-top-sheen: rgba(255, 255, 255, 0.02);
  --card-top-sheen-stop: rgba(255, 255, 255, 0);
  --section-card-base: rgba(255, 255, 255, 0.02);
  --section-card-fade: rgba(255, 255, 255, 0.02);
  --focus-ring: #a3c4ff;
  --card-shadow: 0 18px 42px rgba(3, 7, 18, 0.5);
  --card-inner-outline: inset 0 0 0 1px rgba(231, 237, 246, 0.06);
  --font-ui: 'Manrope', 'Avenir Next', 'Segoe UI', 'Helvetica Neue', sans-serif;
}

.app-shell {
  min-height: 100dvh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  gap: 1rem;
  padding: clamp(1.1rem, 2.8vw, 2.4rem);
  background: var(--canvas-bg);
  color: var(--ink);
  font-family: var(--font-ui);
}

.app-shell--light {
  --canvas-bg: #f2ece0;
  --card-bg: #fbf7ef;
  --ink: #32291f;
  --muted-ink: #7a6c58;
  --line: rgba(84, 67, 44, 0.16);
  --line-strong: rgba(84, 67, 44, 0.25);
  --chip-bg: rgba(84, 67, 44, 0.08);
  --choice-bg: #ece1cd;
  --choice-bg-active: #5a4a35;
  --choice-ink-active: #f7f1e4;
  --card-soft-alert-bg: rgba(188, 103, 61, 0.17);
  --card-soft-alert-border: rgba(145, 71, 42, 0.48);
  --card-soft-alert-ink: #7b3520;
  --card-on-track-bg: rgba(72, 135, 99, 0.17);
  --card-on-track-border: rgba(45, 108, 74, 0.46);
  --card-on-track-ink: #1f563b;
  --select-bg: #f8f2e5;
  --card-accent-glow: rgba(194, 162, 122, 0.24);
  --card-accent-glow-stop: rgba(194, 162, 122, 0);
  --card-top-sheen: rgba(255, 248, 233, 0.42);
  --card-top-sheen-stop: rgba(255, 248, 233, 0);
  --section-card-base: rgba(84, 67, 44, 0.045);
  --section-card-fade: rgba(84, 67, 44, 0.02);
  --focus-ring: #b7976a;
  --card-shadow: 0 12px 30px rgba(78, 61, 40, 0.12);
  --card-inner-outline: inset 0 0 0 1px rgba(84, 67, 44, 0.07);
}

.top-navbar {
  width: min(1080px, 100%);
  margin: 0;
  padding-bottom: 0.72rem;
  border-bottom: 1px solid var(--line-strong);
  color: var(--ink);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: clamp(0.95rem, 2vw, 1.4rem);
}

.top-navbar__title {
  margin: 0;
  flex: 1 1 auto;
  min-width: 0;
  text-align: left;
  font-family: var(--font-ui);
  font-size: clamp(1.3rem, 2.5vw, 1.85rem);
  font-weight: 700;
  letter-spacing: 0.012em;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  padding-right: clamp(0.35rem, 0.9vw, 0.8rem);
}

.theme-toggle {
  --toggle-width: 2.5rem;
  --toggle-height: 1.38rem;
  --toggle-thumb-size: 0.92rem;
  --toggle-edge-gap: 0.13rem;
  --toggle-thumb-travel: calc(var(--toggle-width) - var(--toggle-thumb-size) - (var(--toggle-edge-gap) * 2));
  flex: 0 0 auto;
  width: var(--toggle-width);
  height: var(--toggle-height);
  padding: 0 0.24rem;
  border-radius: 999px;
  border: 1px solid var(--line-strong);
  background: var(--choice-bg);
  color: var(--ink);
  display: inline-flex;
  align-items: center;
  justify-content: space-between;
  position: relative;
  overflow: hidden;
  cursor: pointer;
  transition: background-color 170ms ease, border-color 170ms ease, color 170ms ease;
}

.theme-toggle:hover {
  border-color: var(--line-strong);
  color: var(--muted-ink);
}

.theme-toggle:focus-visible {
  outline: 2px solid var(--focus-ring);
  outline-offset: 2px;
}

.theme-toggle__icon {
  width: 0.68rem;
  height: 0.68rem;
  color: var(--muted-ink);
  z-index: 1;
  transition: color 160ms ease;
}

.theme-toggle__icon--moon {
  color: var(--ink);
}

.theme-toggle--light .theme-toggle__icon--sun {
  color: var(--ink);
}

.theme-toggle--light .theme-toggle__icon--moon {
  color: var(--muted-ink);
}

.theme-toggle__thumb {
  position: absolute;
  top: 50%;
  left: var(--toggle-edge-gap);
  width: var(--toggle-thumb-size);
  height: var(--toggle-thumb-size);
  border-radius: 50%;
  background: var(--ink);
  transform: translate(var(--toggle-thumb-travel), -50%);
  transition: transform 170ms ease, background-color 170ms ease;
}

.theme-toggle--light .theme-toggle__thumb {
  transform: translate(0, -50%);
}

.assessment-layout {
  width: min(1080px, 100%);
  display: flex;
  justify-content: center;
}

.assessment-card {
  width: min(860px, 100%);
  margin-inline: auto;
  padding: clamp(1.1rem, 2.5vw, 2rem);
  border: 2px solid var(--line) !important;
  border-radius: 1.7rem !important;
  background:
    radial-gradient(460px 260px at 95% -10%, var(--card-accent-glow) 0%, var(--card-accent-glow-stop) 72%),
    linear-gradient(175deg, var(--card-top-sheen) 0%, var(--card-top-sheen-stop) 42%),
    var(--card-bg) !important;
  box-shadow: var(--card-shadow), var(--card-inner-outline);
}

.assessment-main {
  width: 100%;
  display: grid;
  align-content: start;
  gap: 1rem;
  animation: content-enter 300ms ease both;
}

.assessment-main--results {
  gap: 1.2rem;
}

.question-header {
  display: grid;
  grid-template-columns: minmax(0, 1fr) auto;
  align-items: stretch;
  gap: 0.35rem 0.7rem;
  border-bottom: 1px solid var(--line);
  padding-bottom: 0.9rem;
}

.assessment-meta {
  --section-lines: 2;
  --section-line-height: 1.18;
  --subsection-lines: 2;
  --subsection-line-height: 1.3;
  --meta-row-gap: 0.14rem;
  --meta-padding-block: 0.24rem;

  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  gap: var(--meta-row-gap);
  padding-block: var(--meta-padding-block);
  min-width: 0;
}

.assessment-meta__section-row,
.assessment-meta__subsection-row {
  min-width: 0;
}

.question-header__section,
.question-header__subsection,
.question-header__progress,
.question-stage__prompt,
.choice-button,
.auto-advance-note,
.nav-button,
.results-subtitle,
.results-total__label,
.results-range-picker__label,
.results-range-picker__select,
.section-total-card__section,
.section-total-card__name,
.section-total-card__score,
.section-total-card__feedback {
  font-family: var(--font-ui);
}

.question-header__section {
  margin: 0;
  color: var(--ink);
  font-size: clamp(1.3rem, 2.7vw, 2.05rem);
  font-weight: 700;
  line-height: var(--section-line-height, 1.18);
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: var(--section-lines, 2);
  min-width: 0;
  overflow: hidden;
  overflow-wrap: anywhere;
}

.question-header__subsection {
  margin: 0;
  color: var(--muted-ink);
  font-size: clamp(0.97rem, 1.75vw, 1.26rem);
  line-height: var(--subsection-line-height, 1.3);
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: var(--subsection-lines, 2);
  min-width: 0;
  overflow: hidden;
  overflow-wrap: anywhere;
}

.question-header__progress {
  grid-column: 2;
  grid-row: 1;
  justify-self: end;
  align-self: center;
  margin: 0;
  padding: 0.16rem 0.5rem;
  border: 1px solid var(--line);
  border-radius: 999px;
  background: var(--chip-bg);
  color: var(--ink);
  font-size: clamp(0.66rem, 1.05vw, 0.78rem);
  font-weight: 620;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  white-space: nowrap;
}

.question-stage {
  display: flex;
  align-items: stretch;
  justify-content: flex-start;
  animation: question-enter 220ms ease both;
}

.question-stage__prompt {
  --prompt-lines: 2;
  --prompt-pad: clamp(0.3rem, 0.7vw, 0.55rem);

  margin: 0;
  max-width: 46ch;
  color: var(--ink);
  font-size: clamp(1.32rem, 2.35vw, 2rem);
  font-weight: 620;
  line-height: 1.45;
  display: flex;
  align-items: center;
  padding-block: var(--prompt-pad);
  min-block-size: calc(var(--prompt-lines) * 1em * 1.45 + (2 * var(--prompt-pad)));
}

.choice-grid {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 0.75rem;
}

.choice-button {
  width: fit-content;
  min-height: 3rem;
  padding: 0.72rem 1.16rem;
  border-radius: 999px;
  border: 1.5px solid var(--line-strong) !important;
  background: var(--choice-bg) !important;
  color: var(--ink) !important;
  font-size: clamp(0.96rem, 1.65vw, 1.12rem);
  font-weight: 650;
  line-height: 1;
  letter-spacing: 0.01em;
  flex: 0 0 auto;
  transition:
    transform 140ms ease,
    background-color 180ms ease,
    color 180ms ease,
    border-color 180ms ease;
}

.choice-button:hover {
  transform: translateY(-1px);
}

.choice-button:focus-visible,
.nav-button:focus-visible {
  outline: 2px solid var(--focus-ring);
  outline-offset: 3px;
}

.choice-button--active {
  background: var(--choice-bg-active) !important;
  color: var(--choice-ink-active) !important;
  border-color: var(--choice-bg-active) !important;
}

.action-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 0.75rem;
  border-top: 1px solid var(--line);
  padding-top: 0.85rem;
}

.auto-advance-note {
  margin: 0;
  color: var(--muted-ink);
  font-size: 0.9rem;
}

.nav-button {
  min-width: 6rem;
  min-height: 2.5rem;
  border: 1.5px solid var(--line-strong) !important;
  border-radius: 0.8rem;
  background: transparent !important;
  color: var(--ink);
  cursor: pointer;
  font-size: 1.02rem;
  transition: background-color 150ms ease, color 150ms ease, border-color 150ms ease;
}

.nav-button:disabled {
  opacity: 0.42;
  cursor: not-allowed;
}

.nav-button:not(:disabled):hover {
  background: var(--ink) !important;
  border-color: var(--ink) !important;
  color: var(--choice-ink-active) !important;
}

.nav-button--primary {
  background: var(--ink) !important;
  border-color: var(--ink) !important;
  color: var(--choice-ink-active) !important;
}

.results-header h1 {
  margin: 0;
  color: var(--ink);
  font-size: clamp(2.15rem, 3.9vw, 3.25rem);
  letter-spacing: -0.01em;
}

.results-subtitle {
  margin: 0.3rem 0 0;
  color: var(--muted-ink);
  font-size: clamp(1.14rem, 2.2vw, 1.5rem);
}

.results-total {
  padding: 0.9rem 0;
  border-top: 1px solid var(--line);
  border-bottom: 1px solid var(--line);
}

.results-total__label {
  margin: 0;
  color: var(--muted-ink);
  font-size: 1.02rem;
  letter-spacing: 0.03em;
  text-transform: uppercase;
}

.results-total__score {
  margin: 0.35rem 0 0;
  color: var(--ink);
  font-size: clamp(2.45rem, 4.9vw, 3.9rem);
  font-weight: 700;
  line-height: 1.05;
}

.results-total__score span {
  color: var(--muted-ink);
  font-size: 0.56em;
}

.results-range-picker {
  display: grid;
  gap: 0.45rem;
}

.results-range-picker__label {
  margin: 0;
  color: var(--muted-ink);
  font-size: 0.94rem;
  letter-spacing: 0.03em;
  text-transform: uppercase;
}

.results-range-picker__control {
  display: grid;
  gap: 0.38rem;
}

.results-range-picker__select {
  width: min(320px, 100%);
  min-height: 2.55rem;
  padding: 0.55rem 0.75rem;
  border-radius: 0.75rem;
  border: 1.5px solid var(--line-strong);
  background: var(--select-bg);
  color: var(--ink);
  font-size: 0.94rem;
  font-weight: 600;
  letter-spacing: 0.01em;
}

.results-range-picker__select:focus-visible {
  outline: 2px solid var(--focus-ring);
  outline-offset: 2px;
}

.results-breakdown {
  padding-top: 0.95rem;
}

.results-breakdown__title {
  margin: 0 0 0.75rem;
  color: var(--muted-ink);
  font-size: 1.01rem;
  /* font-weight: 620; */
  letter-spacing: 0.07em;
  text-transform: uppercase;
}

.results-breakdown__grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 0.7rem;
}

.section-total-card {
  display: grid;
  gap: 0.48rem;
  padding: 0.82rem 0.9rem;
  min-width: 0;
  border: 1px solid var(--line);
  border-radius: 0.85rem;
  background: var(--section-card-base);
  transition: border-color 180ms ease, background-color 180ms ease;
}

.section-total-card--below {
  border-color: var(--card-soft-alert-border);
  background: linear-gradient(180deg, var(--card-soft-alert-bg) 0%, var(--section-card-fade) 100%);
}

.section-total-card--on-track {
  border-color: var(--card-on-track-border);
  background: linear-gradient(180deg, var(--card-on-track-bg) 0%, var(--section-card-fade) 100%);
}

.section-total-card__header {
  display: flex;
  justify-content: flex-start;
  gap: 0.58rem;
  align-items: flex-start;
  min-width: 0;
}

.section-total-card__labels {
  display: grid;
  gap: 0.15rem;
  min-width: 0;
}

.section-total-card__section,
.section-total-card__name,
.section-total-card__score {
  margin: 0;
}

.section-total-card__section {
  --card-section-lines: 2;

  color: var(--muted-ink);
  font-size: 0.76rem;
  letter-spacing: 0.06em;
  text-transform: uppercase;
  line-height: 1.25;
  min-block-size: calc(var(--card-section-lines) * 1em * 1.25);
  display: flex;
  align-items: flex-end;
  overflow-wrap: anywhere;
}

.section-total-card__name {
  --card-subsection-lines: 2;

  display: block;
  min-width: 0;
  color: var(--ink);
  font-size: clamp(1.02rem, 1.45vw, 1.16rem);
  font-weight: 620;
  line-height: 1.35;
  min-block-size: calc(var(--card-subsection-lines) * 1em * 1.35);
  display: flex;
  align-items: flex-start;
  overflow-wrap: anywhere;
}

.section-total-card__score {
  color: var(--ink);
  font-size: clamp(1.42rem, 2.35vw, 1.8rem);
  font-weight: 620;
  white-space: nowrap;
}

.section-total-card__score span {
  color: var(--muted-ink);
  font-size: 0.76em;
}

.section-total-card__feedback {
  margin: 0;
  font-size: 0.79rem;
  line-height: 1.35;
}

.section-total-card__feedback--below {
  color: var(--card-soft-alert-ink);
}

.section-total-card__feedback--on-track {
  color: var(--card-on-track-ink);
}

.results-actions {
  display: flex;
  justify-content: flex-end;
}

@keyframes question-enter {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes content-enter {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@media (max-width: 900px) {
  .assessment-layout {
    justify-content: center;
  }

  .assessment-card,
  .assessment-card--results {
    width: 100%;
    margin-inline: auto;
  }

  .results-actions {
    justify-content: flex-start;
  }
}

@media (max-width: 640px) {
  .app-shell {
    gap: 0.75rem;
    padding: 0.88rem;
  }

  .top-navbar {
    width: 100%;
  }

  .top-navbar__title {
    font-size: clamp(1.2rem, 5.1vw, 1.45rem);
  }

  .theme-toggle {
    --toggle-width: 2.3rem;
    --toggle-height: 1.28rem;
  }

  .question-header {
    gap: 0.32rem 0.55rem;
  }

  .question-header__progress {
    font-size: 0.62rem;
    padding: 0.12rem 0.42rem;
  }

  .question-stage__prompt {
    font-size: clamp(1.04rem, 4.9vw, 1.28rem);
    line-height: 1.4;
  }

  .choice-grid {
    gap: 0.58rem;
  }

  .choice-button {
    min-height: 2.75rem;
    padding: 0.6rem 0.95rem;
    font-size: 0.94rem;
  }

  .assessment-card {
    border-radius: 1.2rem !important;
    padding: 0.9rem;
  }

  .results-breakdown__grid {
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 0.58rem;
  }

  .results-range-picker__select {
    width: 100%;
  }

  .action-row {
    flex-direction: row;
    align-items: center;
  }

  .auto-advance-note {
    font-size: 0.8rem;
    text-align: right;
  }
}

@media (max-width: 460px) {
  .choice-button {
    flex: 1 1 calc(50% - 0.3rem);
    justify-content: center;
  }
}

@media (max-width: 340px) {
  .choice-button {
    flex-basis: 100%;
  }
}
